{% extends "forum/base.html" %}
{% load profile %}
{% load emarkdown %}
{% load i18n %}
{% load interventions %}

{% block title %}
    {% trans "Tag" %} : {{ tag.title }}
{% endblock %}



{% block breadcrumb %}
    <li>{% trans "Tag" %} : {{ tag.title }}</li>
{% endblock %}



{% block headline %}
    {% trans "Tag" %} : {{ tag.title }}
{% endblock %}

{% block sidebar_actions %}
    <li>
    {% with subscribe_array=tag|has_subscribed_new_topic %}
        <form action="{% url 'follow-tag-edit' %}" method="post">
            <input type="hidden" name="tag" value="{{ tag.pk }}">
            <input type="hidden" name="follow" value="{% if subscribe_array.has_subscribed_new %}-1{% else %}1{% endif %}">
            {% csrf_token %}

            <button
                class="follow ico-after star {% if subscribe_array.has_subscribed_new %}yellow{% else %}blue{% endif %}"
                type="submit" data-ajax-input="follow-tag"
                data-content-on-click="
                    {% if subscribe_array.has_subscribed_new %}
                        {% trans "Suivre ce tag" %}
                    {% else %}
                        {% trans "Ne plus suivre ce tag" %}
                    {% endif %}
                "
            >
                {% if subscribe_array.has_subscribed_new %}
                    {% trans "Ne plus suivre ce tag" %}
                {% else %}
                    {% trans "Suivre ce tag" %}
                {% endif %}
            </button>
        </form>
    </li>
    <li>
        <form action="{% url 'follow-tag-edit' %}" method="post">
            <input type="hidden" name="tag" value="{{ tag.pk }}">
            <input type="hidden" name="email" value="{% if subscribe_array.has_subscribed_new_email %}-1{% else %}1{% endif %}">
            {% csrf_token %}

            <button
                class="email ico-after {% if not subscribe_array.has_subscribed_new_email %}blue{% endif %}"
                type="submit" data-ajax-input="follow-tag-by-email"
                data-content-on-click="
                    {% if subscribe_array.has_subscribed_new_email %}
                        {% trans "Être notifié par courriel" %}
                    {% else %}
                        {% trans "Ne plus être notifié par courriel" %}
                    {% endif %}
                "
            >
                {% if subscribe_array.has_subscribed_new_email %}
                    {% trans "Ne plus être notifié par courriel" %}
                {% else %}
                    {% trans "Être notifié par courriel" %}
                {% endif %}
            </button>
        </form>
    {% endwith %}
    </li>
{% endblock %}

{% block feeds_rss %}
    {% include "forum/includes/feed.part.html" with param="?tag=" value=tag.pk %}
{% endblock %}

{% block content %}
    {% include "misc/paginator.html" with position="top" %}

    <div class="topic-list">
        {% for topic in topics %}
            {% include "forum/includes/topic_row.part.html" %}
        {% endfor %}
    </div>

    {% include "misc/paginator.html" with position="bottom" %}
{% endblock %}


{% block sidebar_blocks %}
    <div class="mobile-menu-bloc mobile-all-links mobile-show-ico" data-title="Filtres">
        <h3>{% trans "Filtres" %}</h3>
        <ul>
            <li>
                <a href="{% url 'topic-tag-find' tag.pk tag.slug %}?filter=solve"
                   class="ico-after tick green {% if request.GET.filter == "solve" %}selected{% endif %}"
                >
                    {% trans "Sujets résolus" %}
                </a>
            </li>
            <li>
                <a href="{% url 'topic-tag-find' tag.pk tag.slug %}?filter=unsolve"
                   class="ico-after tick blue {% if request.GET.filter == "unsolve" %}selected{% endif %}"
                >
                    {% trans "Sujets non résolus" %}
                </a>
            </li>
            <li>
                <a href="{% url 'topic-tag-find' tag.pk tag.slug %}?filter=noanswer"
                   class="ico-after view {% if request.GET.filter == "noanswer" %}selected{% endif %}"
                >
                    {% trans "Sujets sans réponse" %}
                </a>
            </li>
            {% if request.GET.filter %}
                <li>
                    <a href="{% url 'topic-tag-find' tag.pk tag.slug %}"
                       class="ico-after cross blue"
                    >
                        {% trans "Annuler le filtre" %}
                    </a>
                </li>
            {% endif %}
        </ul>
    </div>
{% endblock %}